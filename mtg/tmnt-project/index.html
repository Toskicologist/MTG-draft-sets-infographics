<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TMNT - Draft Archetypes Color Wheel</title>
  <meta property="og:title" content="TMNT - Draft Archetypes Color Wheel">
  <meta property="og:description" content="Interactive Magic: The Gathering draft archetype color wheel visualization for Teenage Mutant Ninja Turtles (TMT)">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="TMNT - Draft Archetypes Color Wheel">
  <meta name="twitter:description" content="Interactive Magic: The Gathering draft archetype color wheel for Teenage Mutant Ninja Turtles (TMT)">
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Mana Font CSS from jsDelivr (official npm CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/mana-font@latest/css/mana.min.css" rel="stylesheet" type="text/css" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }

    @media (max-width: 768px) {
      .color-wheel-svg {
        max-height: none !important;
        max-width: 100% !important;
        width: 100% !important;
      }
      .main-container {
        padding: 4px !important;
      }
      .archetype-grid {
        grid-template-columns: 1fr !important;
      }
      .color-grid {
        grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)) !important;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
/**
 * TMNT (Teenage Mutant Ninja Turtles) Draft Archetypes - Color Wheel Visualization
 * 1.0.0 React (STABLE)
 *
 * Set: Teenage Mutant Ninja Turtles (TMT)
 * Release: March 6, 2026
 * Format: 5 enemy-color-pair archetypes
 *
 * CHANGELOG:
 * 1.0.4 (2026-02-28, UTC) - [Claude Sonnet 4.6] - Header cleanup; Scryfall button updates
 *   - Merged low-contrast sources warning into subtitle paragraph (readable dark-on-light)
 *   - Added Scryfall full set link to subtitle
 *   - Color boxes: replaced "X identity" (id=X) with "X included" (id>=X)
 *   - Archetype table cards: removed redundant "Full TMT" button (now in subtitle)
 * 1.0.3 (2026-02-28, UTC) - [Claude Sonnet 4.6] - Dim off-arch lines and boxes on wheel
 *   - Secondary (allied-pair) edge lines now render at 45% opacity vs 100% for primary
 *   - Secondary label boxes now render at 50% opacity vs 100% for primary
 *   - Dimmed-hover thresholds adjusted accordingly (0.1 / 0.15)
 * 1.0.2 (2026-02-28, UTC) - [Claude Sonnet 4.6] - Popup on wheel only; Scryfall buttons in archetype tables
 *   - InfoPanel popup now triggered only by SVG color wheel hover, not table cards
 *   - Added Scryfall search buttons inline in all 10 archetype table cards (primary + secondary)
 *   - Removed onMouseEnter/onMouseLeave handlers from table card divs
 * 1.0.1 (2026-02-28, UTC) - [Claude Sonnet 4.6] - Fix sourcing: wire up per-archetype sourceText/sourceUrl
 *   - labels[] now has sourceText + sourceUrl per pair (was dead data before)
 *   - InfoPanel now renders actual source link from labels, not the unused sourceLinks object
 *   - Archetype grid cards now show source attribution
 *   - Header now has explicit sourcing disclosure with links to all 4 sources
 *   - Removed unused sourceLinks object
 *   - Mechanic descriptions now clearly flagged as pre-release expert consensus
 * 1.0.0 (2026-02-27, UTC) - [Claude Sonnet 4.6] - Initial build for TMNT set
 *   - Enemy-color-pair archetypes: WB (Sneak), UR (Machines), BG (Disappear), RW (Alliance), GU (Mutagen)
 *   - Sources: Wizards prerelease guide, Draftsim, CardGameBase, TheGamer
 */

const { useState, useEffect, useRef } = React;

const isMobile = () => window.innerWidth <= 768;

const getConfig = (textSizeMultiplier = 1.0) => {
  const mobile = isMobile();
  const baseFontSize = mobile ? 10 : 11;
  const scaledFontSize = Math.round(baseFontSize * textSizeMultiplier);
  return {
    width: 700,
    height: 700,
    cx: 350,
    cy: 330,
    radius: mobile ? 140 : 180,
    nodeRadius: mobile ? 24 : 30,
    edgeWidth: mobile ? 4 : 5,
    boxW: mobile ? 58 : 62,
    boxH: mobile ? 32 : 36,
    primaryBoxW: mobile ? 68 : 72,
    primaryBoxH: mobile ? 40 : 44,
    fontSize: scaledFontSize,
    lineSpacing: mobile ? 9 : 10,
    iterMax: 240,
    pushStep: 6,
  };
};

let CONFIG = getConfig();

const baseHex = {
  W: "#FFFFFF",
  U: "#3366FF",
  B: "#000000",
  R: "#FF3333",
  G: "#2ECC40",
};

// TMNT uses enemy-color-pair archetypes (the 5 supported pairs)
const primaryArchetypes = ['WB', 'UR', 'BG', 'RW', 'GU'];


const manaClasses = {
  W: 'ms ms-w',
  U: 'ms ms-u',
  B: 'ms ms-b',
  R: 'ms ms-r',
  G: 'ms ms-g',
};

const colorDescriptions = {
  W: {
    name: "White",
    description: "Sneaky ninjas, Alliance go-wide. Features Leonardo's Foot Clan discipline and Sally Pride's coalition-building. Partners with Black (Sneak) and Red (Alliance)."
  },
  U: {
    name: "Blue",
    description: "Artifact machines and Mutagen science. Donatello's technology drives artifact synergies. Partners with Red (Machines) and Green (Mutagen tokens)."
  },
  B: {
    name: "Black",
    description: "Ninja deception and Disappear triggers. When your permanents leave the battlefield, generate value. Partners with White (Sneak) and Green (Disappear)."
  },
  R: {
    name: "Red",
    description: "Aggressive Alliance and artifact combat. Raphael's raw attitude fuels attack triggers. Partners with White (Alliance) and Blue (Machines artifacts)."
  },
  G: {
    name: "Green",
    description: "Mutagen tokens and graveyard Disappear. Mutant creatures grow and multiply. Partners with Blue (Mutagen) and Black (Disappear value)."
  }
};

// TMNT archetypes: 5 enemy pairs are primary, 5 allied pairs are secondary/off-theme
// Archetype names and mechanic descriptions sourced from:
//   - Wizards of the Coast prerelease guide / product page
//   - Draftsim TMNT limited set review (draftsim.com/mtg-tmt-limited-set-review/)
//   - TheGamer TMNT draft archetypes article
//   - GameDaily TMNT prerelease guide
// "Best-performing" claims come from pre-release expert consensus; no 17Lands data yet (set releases 2026-03-06)
const labels = {
  // Primary enemy-pair archetypes
  WB: { text: "Ninjas", sub: "Sneak", details: "Sneak mechanic replaces unblocked creatures with stronger ninja threats from hand or library. Leonardo and Splinter lead disciplined strike forces that attack from the shadows. Overwhelming tempo advantage when sneaks resolve.", sourceText: "WotC / Draftsim / TheGamer", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  UR: { text: "Machines", sub: "Artifacts", details: "Donatello's lab powers artifact-heavy Blue/Red decks. Technodrome, robots, and gadgets generate value and board presence. Pre-release consensus: one of the stronger archetypes ‚Äî combine artifact synergies with aggressive Red threats.", sourceText: "WotC / Draftsim / TheGamer", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  BG: { text: "Ooze", sub: "Disappear", details: "Disappear triggers when your permanents leave the battlefield, generating value through sacrifice and removal. Michelangelo's chaos and the ooze subtype create recursive value loops. Great at grinding out opponents.", sourceText: "WotC / Draftsim / GameDaily", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  RW: { text: "Alliance", sub: "Go-wide tokens", details: "Alliance is a returning mechanic that triggers whenever another creature enters under your control. Stack creature-count payoffs, go wide with tokens, and overwhelm opponents. Recommended by reviewers for newer players ‚Äî straightforward and powerful.", sourceText: "WotC / Draftsim / TheGamer", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  GU: { text: "Mutagen", sub: "Mutant tokens", details: "Mutagen tokens represent the ooze that transforms ordinary creatures into mutants. Pre-release consensus: one of the stronger archetypes ‚Äî grow enormous mutant threats while accumulating incremental value. The Mutagen Man epitomizes this strategy.", sourceText: "WotC / Draftsim / TheGamer", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  // Secondary allied-pair notes (off-archetype splashes)
  WU: { text: "Off-arch", sub: "Splash W/U", details: "No dedicated WU archetype in TMT. This color pair bridges Ninjas (WB) and Machines (UR). Consider splashing for powerful individual cards ‚Äî Krang Master Mind (U), Sally Pride (W) are exceptional off-color inclusions.", sourceText: "Draftsim pre-release review", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  UB: { text: "Off-arch", sub: "Splash U/B", details: "No dedicated UB archetype. Bridges Machines (UR) and Ooze/Disappear (BG). April O'Neil works in either direction. Splashing strong black removal or blue card draw is viable if your manabase supports it.", sourceText: "Draftsim pre-release review", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  BR: { text: "Off-arch", sub: "Splash B/R", details: "No dedicated BR archetype. Bridges Ooze (BG) and Alliance (RW). Raphael cards span both colors. Aggressive black/red builds can work with creature-based removal and direct pressure.", sourceText: "Draftsim pre-release review", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  RG: { text: "Off-arch", sub: "Splash R/G", details: "No dedicated RG archetype. Bridges Alliance (RW) and Mutagen (GU). Green ramp into red threats is viable. Groundchuck & Dirtbag provide Mutagen-adjacent value in non-dedicated builds.", sourceText: "Draftsim pre-release review", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
  GW: { text: "Off-arch", sub: "Splash G/W", details: "No dedicated GW archetype. Bridges Mutagen (GU) and Ninja/Alliance (WB, RW). Sally Pride's Alliance payoffs pair naturally with green's wide board. Token-heavy GW shells can work around Alliance triggers.", sourceText: "Draftsim pre-release review", sourceUrl: "https://draftsim.com/mtg-tmt-limited-set-review/" },
};

const hexToRgb = (h) => {
  const hex = h.replace('#', '');
  return [
    parseInt(hex.substring(0, 2), 16),
    parseInt(hex.substring(2, 4), 16),
    parseInt(hex.substring(4, 6), 16),
  ];
};

const rgbToHex = (r, g, b) =>
  '#' + [r, g, b].map(x => Math.round(x).toString(16).padStart(2, '0')).join('');

const darken = (h, amt = 0.4) => {
  const [r, g, b] = hexToRgb(h);
  return rgbToHex(r * (1 - amt), g * (1 - amt), b * (1 - amt));
};

const blend = (u, v) => {
  const [r1, g1, b1] = hexToRgb(baseHex[u]);
  const [r2, g2, b2] = hexToRgb(baseHex[v]);
  return rgbToHex((r1 + r2) / 2, (g1 + g2) / 2, (b1 + b2) / 2);
};

const relLum = (h) => {
  const [r, g, b] = hexToRgb(h).map(x => x / 255);
  const f = (c) => (c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4));
  return 0.2126 * f(r) + 0.7152 * f(g) + 0.0722 * f(b);
};

const contrastRatio = (bg, fg) => {
  const [L1, L2] = [relLum(bg), relLum(fg)].sort((a, b) => b - a);
  return (L1 + 0.05) / (L2 + 0.05);
};

const getLabelColors = (u, v) => {
  let bg, fg;
  if (u === 'B' || v === 'B') {
    bg = '#000000';
    const partner = u === 'B' ? v : u;
    fg = partner === 'W' ? '#FFFFFF' : baseHex[partner];
  } else if (u === 'W' || v === 'W') {
    const partner = u === 'W' ? v : u;
    bg = darken(baseHex[partner], 0.4);
    fg = '#FFFFFF';
  } else {
    bg = darken(baseHex[u], 0.4);
    fg = baseHex[v];
    if (contrastRatio(bg, fg) < 4.5) {
      const [r, g, b] = hexToRgb(fg);
      fg = rgbToHex(Math.min(r + 140, 255), Math.min(g + 140, 255), Math.min(b + 140, 255));
    }
  }
  return { bg, fg };
};

const colorOrder = ['W', 'U', 'B', 'R', 'G'];

const edges = Object.keys(labels).map(pair => ({
  u: pair[0],
  v: pair[1],
  uIdx: colorOrder.indexOf(pair[0]),
  vIdx: colorOrder.indexOf(pair[1]),
}));

const getNodePos = (index, config) => {
  const angle = (index * 72 - 90) * (Math.PI / 180);
  return {
    x: config.cx + config.radius * Math.cos(angle),
    y: config.cy + config.radius * Math.sin(angle),
  };
};

const getNodePositions = (config) => colorOrder.map((_, i) => getNodePos(i, config));

const getEdgeGeometry = (uIdx, vIdx, config) => {
  const nodePositions = getNodePositions(config);
  const p1 = nodePositions[uIdx];
  const p2 = nodePositions[vIdx];
  const dx = p2.x - p1.x;
  const dy = p2.y - p1.y;
  const L = Math.hypot(dx, dy);
  const ux = dx / L;
  const uy = dy / L;

  const x = (p1.x + ux * config.nodeRadius + p2.x - ux * config.nodeRadius) / 2;
  const y = (p1.y + uy * config.nodeRadius + p2.y - uy * config.nodeRadius) / 2;

  const tx = ux, ty = uy;
  const nx = -uy, ny = ux;

  return { x, y, tx, ty, nx, ny };
};

const getBbox = (cx, cy, isPrimary, config) => {
  const w = isPrimary ? config.primaryBoxW : config.boxW;
  const h = isPrimary ? config.primaryBoxH : config.boxH;
  return {
    x1: cx - w / 2,
    x2: cx + w / 2,
    y1: cy - h / 2,
    y2: cy + h / 2,
  };
};

const isOverlap = (b1, b2, margin = 2) => {
  return !(b1.x2 + margin < b2.x1 || b2.x2 + margin < b1.x1 ||
           b1.y2 + margin < b2.y1 || b2.y2 + margin < b1.y1);
};

const computeLabelPositions = (config) => {
  const groups = edges.map(edge => {
    const pairCode = edge.u + edge.v;
    const isPrimary = primaryArchetypes.includes(pairCode);
    const { x, y, tx, ty, nx, ny } = getEdgeGeometry(edge.uIdx, edge.vIdx, config);

    const sgn = (x - config.cx) * nx + (y - config.cy) * ny > 0 ? 1 : -1;
    const off = sgn * (isPrimary ? 20 : 15);
    const tshift = edge.u < edge.v ? 3 : -3;

    const cx = x + nx * off + tx * tshift;
    const cy = y + ny * off + ty * tshift;

    return {
      ...edge,
      cx,
      cy,
      isPrimary,
      bbox: getBbox(cx, cy, isPrimary, config),
    };
  });

  for (let iter = 0; iter < config.iterMax; iter++) {
    let moved = false;
    for (let i = 0; i < groups.length; i++) {
      for (let j = i + 1; j < groups.length; j++) {
        if (isOverlap(groups[i].bbox, groups[j].bbox)) {
          const dx = groups[i].cx - groups[j].cx;
          const dy = groups[i].cy - groups[j].cy;
          const L = Math.hypot(dx, dy) + 0.001;

          groups[i].cx += (dx / L) * config.pushStep;
          groups[i].cy += (dy / L) * config.pushStep;
          groups[j].cx -= (dx / L) * config.pushStep;
          groups[j].cy -= (dy / L) * config.pushStep;

          groups[i].bbox = getBbox(groups[i].cx, groups[i].cy, groups[i].isPrimary, config);
          groups[j].bbox = getBbox(groups[j].cx, groups[j].cy, groups[j].isPrimary, config);
          moved = true;
        }
      }
    }
    if (!moved) break;
  }

  return groups;
};

const ManaSymbol = ({ color, size = 24, isSimple = false }) => {
  const fontColor = isSimple ? '#000000' : (color === 'W' ? '#000000' : '#FFFFFF');
  return (
    <i
      className={manaClasses[color]}
      style={{
        fontSize: `${size}px`,
        color: fontColor,
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
      }}
    />
  );
};

const ColorNode = ({ color, index, isHighlighted, isDimmed, onHover, onLeave, isSimple = false, config }) => {
  const nodePositions = getNodePositions(config);
  const pos = nodePositions[index];
  const fontColor = isSimple ? '#000000' : (color === 'W' ? '#000000' : '#FFFFFF');
  const nodeColor = isSimple ? '#FFFFFF' : baseHex[color];
  const glowColor = isSimple ? 'transparent' : baseHex[color];

  return (
    <g
      onMouseEnter={onHover}
      onMouseLeave={onLeave}
      style={{ cursor: 'pointer', transition: 'opacity 0.2s ease' }}
      opacity={isDimmed ? 0.3 : 1}
    >
      <circle
        cx={pos.x}
        cy={pos.y}
        r={config.nodeRadius + (isHighlighted ? 12 : 8)}
        fill={isHighlighted ? "#FFD700" : glowColor}
        opacity={isHighlighted ? 0.6 : 0.25}
        style={{ transition: 'all 0.2s ease' }}
      />
      <circle
        cx={pos.x}
        cy={pos.y}
        r={config.nodeRadius}
        fill={nodeColor}
        stroke={isHighlighted ? "#FFD700" : "#000000"}
        strokeWidth={isHighlighted ? 4 : 3}
        style={{ transition: 'all 0.2s ease' }}
      />
      <foreignObject
        x={pos.x - 20}
        y={pos.y - 20}
        width={40}
        height={40}
      >
        <div style={{
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
          width: '40px',
          height: '40px',
          color: fontColor,
        }}>
          <ManaSymbol color={color} size={30} isSimple={isSimple} />
        </div>
      </foreignObject>
    </g>
  );
};

const EdgeLine = ({ edge, isHighlighted, isDimmed, isSimple = false, config }) => {
  const nodePositions = getNodePositions(config);
  const p1 = nodePositions[edge.uIdx];
  const p2 = nodePositions[edge.vIdx];
  const pairCode = edge.u + edge.v;
  const isPrimary = primaryArchetypes.includes(pairCode);
  const lineColor = isSimple ? '#000000' : blend(edge.u, edge.v);
  const lineOpacity = isDimmed ? 0.1 : (isPrimary ? 1 : 0.45);

  return (
    <line
      x1={p1.x}
      y1={p1.y}
      x2={p2.x}
      y2={p2.y}
      stroke={isHighlighted ? "#FFD700" : lineColor}
      strokeWidth={isHighlighted ? config.edgeWidth + 3 : (isPrimary ? config.edgeWidth + 2 : config.edgeWidth)}
      opacity={lineOpacity}
      style={{ transition: 'all 0.2s ease' }}
    />
  );
};

const LabelBox = ({ group, isHighlighted, isDimmed, onHover, onLeave, isSimple = false, config }) => {
  const groupRef = useRef(null);
  const [boxSize, setBoxSize] = useState({ width: 50, height: 35 });

  const code = group.u + group.v;
  const labelData = labels[code] || labels[group.v + group.u];
  const { bg, fg } = getLabelColors(group.u, group.v);
  const edgeColor = blend(group.u, group.v);
  const isPrimary = group.isPrimary;
  const subLines = labelData.sub.split('\n');
  const boxBg = isSimple ? '#FFFFFF' : bg;
  const boxStroke = isSimple ? '#000000' : edgeColor;
  const textColor = isSimple ? '#000000' : fg;

  const fontSize1 = config.fontSize;
  const fontSize2 = config.fontSize;
  const fontSize3 = config.fontSize;
  const lh1 = fontSize1 * 1.1;
  const lh2 = fontSize2 * 1.1;
  const lh3 = fontSize3 * 1.1;
  const subLineSpacing = 7;
  const numSubLines = subLines.length;
  const totalTextHeight = lh1 + lh2 + lh3 + (numSubLines - 1) * subLineSpacing;
  const startY = group.cy - totalTextHeight / 2;
  const y1 = startY + lh1 * 0.8;
  const y2 = y1 + lh2;
  const y3 = y2 + lh3 * 0.9;

  useEffect(() => {
    if (groupRef.current) {
      const texts = groupRef.current.querySelectorAll('text');
      let maxWidth = 0;
      texts.forEach((text) => {
        try {
          const bbox = text.getBBox();
          maxWidth = Math.max(maxWidth, bbox.width);
        } catch (e) {}
      });
      const padding = 4;
      const heightPadding = 3;
      setBoxSize({
        width: Math.max(maxWidth + padding * 2, 35),
        height: totalTextHeight + heightPadding * 2
      });
    }
  }, [code, labelData.text, labelData.sub, config.fontSize, totalTextHeight]);

  return (
    <g
      ref={groupRef}
      onMouseEnter={onHover}
      onMouseLeave={onLeave}
      style={{ cursor: 'pointer', transition: 'all 0.2s ease' }}
      opacity={isDimmed ? 0.15 : (isPrimary ? 1 : 0.5)}
      transform={isHighlighted ? `translate(${group.cx}, ${group.cy}) scale(1.08) translate(${-group.cx}, ${-group.cy})` : undefined}
    >
      <rect
        x={group.cx - boxSize.width / 2}
        y={group.cy - boxSize.height / 2}
        width={boxSize.width}
        height={boxSize.height}
        rx={4}
        fill={boxBg}
        stroke={isHighlighted ? "#FFD700" : boxStroke}
        strokeWidth={isHighlighted ? 3 : (isPrimary ? 2 : 1.5)}
        style={{ transition: 'all 0.2s ease' }}
      />
      <text x={group.cx} y={y1} textAnchor="middle" fontSize={fontSize1} fontWeight="bold" fill={textColor}>
        {code}
      </text>
      <text x={group.cx} y={y2} textAnchor="middle" fontSize={fontSize2} fontWeight={isPrimary ? "bold" : "normal"} fill={textColor}>
        {labelData.text}
      </text>
      <text x={group.cx} y={y3} textAnchor="middle" fontSize={fontSize3} fill={textColor} opacity={0.85}>
        {subLines.map((line, i) => (
          <tspan key={i} x={group.cx} dy={i === 0 ? 0 : subLineSpacing}>{line}</tspan>
        ))}
      </text>
    </g>
  );
};

const ColorGrid = ({ hoveredColor, onColorHover, onColorLeave }) => {
  return (
    <div id="colors" className="color-grid" style={{
      display: 'grid',
      gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',
      gap: '12px',
      marginTop: '24px',
      width: '100%',
    }}>
      {colorOrder.map((color) => {
        const colorData = colorDescriptions[color];
        const colorMap = { W: 'white', U: 'blue', B: 'black', R: 'red', G: 'green' };
        const exactSearchUrl = `https://scryfall.com/search?q=set%3Atmt+color%3D${colorMap[color]}`;
        const includedSearchUrl = `https://scryfall.com/search?q=set%3Atmt+id>%3D${color}`;
        const bg = baseHex[color];
        const fg = color === 'W' ? '#000000' : '#FFFFFF';
        const isHovered = hoveredColor === color;

        return (
          <div
            key={color}
            onMouseEnter={() => onColorHover(color)}
            onMouseLeave={onColorLeave}
            style={{
              backgroundColor: bg,
              color: fg,
              padding: '12px',
              borderRadius: '6px',
              textAlign: 'center',
              border: isHovered ? `3px solid #FFD700` : `2px solid ${darken(bg, 0.2)}`,
              boxShadow: isHovered ? '0 0 8px rgba(255, 215, 0, 0.4)' : '0 2px 4px rgba(0,0,0,0.1)',
              transition: 'all 0.2s ease',
              cursor: 'pointer',
            }}
          >
            <div style={{ fontSize: '40px', marginBottom: '6px', color: fg }}>
              <i className={manaClasses[color]} />
            </div>
            <div style={{ fontWeight: 'bold', fontSize: '0.9rem', marginBottom: '4px' }}>
              {color}: {colorData.name}
            </div>
            <div style={{ fontSize: '0.75rem', lineHeight: '1.3', marginBottom: '8px', opacity: 0.9 }}>
              {colorData.description}
            </div>
            <div style={{ fontSize: '0.65rem', opacity: 0.85, marginBottom: '6px', fontWeight: '600' }}>
              Scryfall search:
            </div>
            <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>
              <a
                href={exactSearchUrl}
                target="_blank"
                rel="noopener noreferrer"
                style={{
                  display: 'inline-block',
                  padding: '4px 8px',
                  backgroundColor: fg,
                  color: bg,
                  textDecoration: 'none',
                  borderRadius: '3px',
                  fontSize: '0.65rem',
                  fontWeight: '600',
                  transition: 'opacity 0.2s ease',
                  opacity: 0.95,
                }}
              >
                {color} only
              </a>
              <a
                href={includedSearchUrl}
                target="_blank"
                rel="noopener noreferrer"
                style={{
                  display: 'inline-block',
                  padding: '4px 8px',
                  backgroundColor: fg,
                  color: bg,
                  textDecoration: 'none',
                  borderRadius: '3px',
                  fontSize: '0.65rem',
                  fontWeight: '600',
                  transition: 'opacity 0.2s ease',
                  opacity: 0.95,
                }}
              >
                {color} included
              </a>
            </div>
          </div>
        );
      })}
    </div>
  );
};

const InfoPanel = ({ pair, onHover, onLeave }) => {
  if (!pair) return null;

  const labelData = labels[pair];
  const { bg, fg } = getLabelColors(pair[0], pair[1]);
  const isPrimary = primaryArchetypes.includes(pair);

  const exactSearchUrl = `https://scryfall.com/search?q=set%3Atmt+id%3D${pair}`;
  const orSearchUrl = `https://scryfall.com/search?q=set%3Atmt+(id%3D${pair[0]}+or+id%3D${pair[1]}+or+id%3D${pair})`;
  const scrySetUrl = `https://scryfall.com/sets/tmt`;

  return (
    <div
      onMouseEnter={onHover}
      onMouseLeave={onLeave}
      style={{
        position: 'fixed',
        bottom: '20px',
        left: '50%',
        transform: 'translateX(-50%)',
        backgroundColor: bg,
        color: fg,
        padding: '16px 24px',
        borderRadius: '8px',
        border: `2px solid ${blend(pair[0], pair[1])}`,
        maxWidth: '500px',
        textAlign: 'center',
        boxShadow: '0 4px 12px rgba(0,0,0,0.3)',
        transition: 'all 0.2s ease',
        zIndex: 1000,
      }}>
      <div style={{ fontWeight: 'bold', fontSize: '1.2rem', marginBottom: '4px' }}>
        {pair}: {labelData.text} {isPrimary ? '‚òÖ' : ''}
      </div>
      <div style={{ fontSize: '0.9rem', opacity: 0.9, marginBottom: '8px' }}>
        {labelData.sub}
      </div>
      <div style={{ fontSize: '0.85rem', lineHeight: '1.4', marginBottom: '8px' }}>
        {labelData.details}
      </div>
      {labelData.sourceText && (
        <div style={{ fontSize: '0.75rem', opacity: 0.8, marginBottom: '12px', fontStyle: 'italic' }}>
          Source: <a href={labelData.sourceUrl} target="_blank" rel="noopener noreferrer" style={{ color: fg, textDecoration: 'underline' }}>{labelData.sourceText}</a>
          {' ¬∑ Pre-release expert consensus; no 17Lands data yet'}
        </div>
      )}
      <div style={{ fontSize: '0.7rem', opacity: 0.9, marginBottom: '8px', fontWeight: '600' }}>
        Scryfall search:
      </div>
      <div style={{ display: 'flex', gap: '6px', justifyContent: 'center', flexWrap: 'wrap' }}>
        <a href={exactSearchUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '6px 14px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '4px', fontSize: '0.75rem', fontWeight: '600' }}>
          {pair[0]}&amp;{pair[1]}
        </a>
        <a href={orSearchUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '6px 14px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '4px', fontSize: '0.75rem', fontWeight: '600' }}>
          {pair[0]}‚à™{pair[1]}
        </a>
        <a href={scrySetUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '6px 14px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '4px', fontSize: '0.75rem', fontWeight: '600' }}>
          Full TMT Set
        </a>
      </div>
    </div>
  );
};

function TMNTColorWheel() {
  const [hoveredNode, setHoveredNode] = useState(null);
  const [hoveredPair, setHoveredPair] = useState(null);
  const [hoveredColor, setHoveredColor] = useState(null);
  const [isSimple, setIsSimple] = useState(false);
  const [textSize, setTextSize] = useState(1.0);
  const [config, setConfig] = useState(() => getConfig(1.0));
  const pairTimeoutRef = useRef(null);
  const colorTimeoutRef = useRef(null);

  useEffect(() => {
    const handleResize = () => { setConfig(getConfig(textSize)); };
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, [textSize]);

  useEffect(() => { setConfig(getConfig(textSize)); }, [textSize]);

  const labelPositions = computeLabelPositions(config);

  const handlePairHover = (pairCode) => {
    if (pairTimeoutRef.current) { clearTimeout(pairTimeoutRef.current); pairTimeoutRef.current = null; }
    setHoveredPair(pairCode);
  };

  const handlePairLeave = () => {
    pairTimeoutRef.current = setTimeout(() => { setHoveredPair(null); }, 800);
  };

  const handleColorHover = (color) => {
    if (colorTimeoutRef.current) { clearTimeout(colorTimeoutRef.current); colorTimeoutRef.current = null; }
    setHoveredColor(color);
  };

  const handleColorLeave = () => {
    colorTimeoutRef.current = setTimeout(() => { setHoveredColor(null); }, 800);
  };

  useEffect(() => {
    const handleHashChange = () => {
      const hash = window.location.hash.slice(1);
      if (hash) {
        const element = document.getElementById(hash);
        if (element) element.scrollIntoView({ behavior: 'smooth' });
      }
    };
    window.addEventListener('hashchange', handleHashChange);
    handleHashChange();
    return () => window.removeEventListener('hashchange', handleHashChange);
  }, []);

  useEffect(() => {
    return () => {
      if (pairTimeoutRef.current) clearTimeout(pairTimeoutRef.current);
      if (colorTimeoutRef.current) clearTimeout(colorTimeoutRef.current);
    };
  }, []);

  const activeColors = hoveredPair ? [hoveredPair[0], hoveredPair[1]] : (hoveredNode ? [hoveredNode] : []);
  const activePair = hoveredPair;

  const primaryPairs = Object.entries(labels).filter(([pair]) => primaryArchetypes.includes(pair));
  const secondaryPairs = Object.entries(labels).filter(([pair]) => !primaryArchetypes.includes(pair));

  return (
    <div className="main-container" style={{
      minHeight: '100vh',
      backgroundColor: '#FFFFFF',
      padding: '24px',
      fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
      display: 'flex',
      flexDirection: 'column',
      alignItems: 'center',
      position: 'relative',
    }}>
      {/* Header */}
      <div style={{ textAlign: 'center', marginBottom: '24px' }}>
        <h1 style={{ fontSize: '1.8rem', fontWeight: '700', color: '#111827', margin: '0 0 4px 0' }}>
          üê¢ Teenage Mutant Ninja Turtles
        </h1>
        <p style={{ fontSize: '0.95rem', color: '#6B7280', margin: '0 0 4px 0' }}>
          Draft Archetypes Color Wheel (1.0.0 Interactive)
        </p>
        <p style={{ fontSize: '0.75rem', color: '#9CA3AF', margin: '0 0 4px 0' }}>
          Set code: TMT ¬∑ Releases: March 6, 2026 ¬∑ Last updated: 2026-02-27 UTC
        </p>
        <div style={{ display: 'inline-block', margin: '4px 0 8px', padding: '4px 12px', borderRadius: '999px', background: '#10B981', color: 'white', fontSize: '0.75rem', fontWeight: '600' }}>
          ‚òÖ 5 enemy-color-pair archetypes
        </div>
        <p style={{ fontSize: '0.85rem', color: '#9CA3AF', margin: '4px 0 8px 0' }}>
          <a href="#colors" style={{ color: '#2563EB', textDecoration: 'underline' }}>Colors</a> | <a href="#primary-archetypes" style={{ color: '#2563EB', textDecoration: 'underline' }}>Primary Archetypes</a> | <a href="#secondary-archetypes" style={{ color: '#2563EB', textDecoration: 'underline' }}>Off-Arch Splashes</a>
        </p>
        <p style={{ fontSize: '0.8rem', color: '#6B7280', margin: '0 0 0 0', lineHeight: '1.6' }}>
          New to this set? See the <a href="https://magic.wizards.com/en/products/teenage-mutant-ninja-turtles" target="_blank" rel="noopener noreferrer" style={{ color: '#2563EB', textDecoration: 'underline' }}>TMNT Product Page</a> or browse the <a href="https://scryfall.com/sets/tmt" target="_blank" rel="noopener noreferrer" style={{ color: '#2563EB', textDecoration: 'underline' }}>full set on Scryfall</a>.<br />
          Want full ratings? See <a href="https://draftsim.com/mtg-tmt-limited-set-review/" target="_blank" rel="noopener noreferrer" style={{ color: '#2563EB', textDecoration: 'underline' }}>Draftsim set review</a>, <a href="https://www.thegamer.com/magic-the-gathering-teenage-mutant-ninja-turtles-best-draft-archetypes/" target="_blank" rel="noopener noreferrer" style={{ color: '#2563EB', textDecoration: 'underline' }}>TheGamer archetypes guide</a>, <a href="https://gamedaily.com/games/mtg-teenage-mutant-ninja-turtles-prerelease-guide-all-limited-archetypes-explained/" target="_blank" rel="noopener noreferrer" style={{ color: '#2563EB', textDecoration: 'underline' }}>GameDaily prerelease guide</a>, or <a href="ratings.html" style={{ color: '#2563EB', textDecoration: 'underline' }}>our Ratings Viewer</a>.
        </p>
      </div>

      {/* Controls */}
      <div style={{ display: 'flex', gap: '24px', alignItems: 'center', justifyContent: 'center', marginBottom: '12px', flexWrap: 'wrap' }}>
        <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer', fontSize: '0.9rem', fontWeight: '500', color: '#374151' }}>
          <input type="checkbox" checked={isSimple} onChange={(e) => setIsSimple(e.target.checked)} style={{ width: '16px', height: '16px', cursor: 'pointer' }} />
          B&amp;W
        </label>
        <label style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '0.9rem', fontWeight: '500', color: '#374151' }}>
          Text Size:
          <input type="range" min="0.5" max="2.0" step="0.1" value={textSize} onChange={(e) => setTextSize(parseFloat(e.target.value))} style={{ width: '80px', cursor: 'pointer' }} />
          <span style={{ minWidth: '35px', fontSize: '0.8rem', color: '#6B7280' }}>{Math.round(textSize * 100)}%</span>
        </label>
      </div>

      {/* SVG Color Wheel */}
      <svg
        className="color-wheel-svg"
        viewBox={isMobile() ? "160 140 380 400" : "120 100 460 480"}
        style={{ width: '100%', maxWidth: '700px', height: 'auto', display: 'block', margin: '0 auto' }}
      >
        {edges.map((edge, i) => {
          const pairCode = edge.u + edge.v;
          const isHighlighted = activePair === pairCode;
          const isDimmed = activeColors.length > 0 && !activeColors.includes(edge.u) && !activeColors.includes(edge.v);
          return (
            <EdgeLine key={`edge-${i}`} edge={edge} isHighlighted={isHighlighted} isDimmed={isDimmed} isSimple={isSimple} config={config} />
          );
        })}

        {labelPositions.map((group, i) => {
          const pairCode = group.u + group.v;
          const isHighlighted = activePair === pairCode;
          const isDimmed = activeColors.length > 0 && !activeColors.includes(group.u) && !activeColors.includes(group.v);
          return (
            <LabelBox
              key={`label-${i}`}
              group={group}
              isHighlighted={isHighlighted}
              isDimmed={isDimmed}
              onHover={() => handlePairHover(pairCode)}
              onLeave={handlePairLeave}
              isSimple={isSimple}
              config={config}
            />
          );
        })}

        {colorOrder.map((color, index) => {
          const isHighlighted = hoveredNode === color || activeColors.includes(color);
          const isDimmed = activeColors.length > 0 && !activeColors.includes(color);
          return (
            <ColorNode
              key={`node-${color}`}
              color={color}
              index={index}
              isHighlighted={isHighlighted}
              isDimmed={isDimmed}
              onHover={() => setHoveredNode(color)}
              onLeave={() => setHoveredNode(null)}
              isSimple={isSimple}
              config={config}
            />
          );
        })}
      </svg>

      {/* Color Grid */}
      <ColorGrid hoveredColor={hoveredColor} onColorHover={handleColorHover} onColorLeave={handleColorLeave} />

      {/* Primary Archetypes */}
      <div id="primary-archetypes" style={{ width: '100%', marginTop: '32px' }}>
        <h2 style={{ fontSize: '1.3rem', fontWeight: '700', color: '#111827', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #10B981' }}>
          ‚òÖ Primary Archetypes (Enemy Color Pairs)
        </h2>
        <div className="archetype-grid" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(min(100%, 150px), 1fr))', gap: '12px', alignSelf: 'stretch' }}>
          {primaryPairs.map(([pair, data]) => {
            const { bg, fg } = getLabelColors(pair[0], pair[1]);
            const exactSearchUrl = `https://scryfall.com/search?q=set%3Atmt+id%3D${pair}`;
            const orSearchUrl = `https://scryfall.com/search?q=set%3Atmt+(id%3D${pair[0]}+or+id%3D${pair[1]}+or+id%3D${pair})`;
            return (
              <div key={pair} style={{ backgroundColor: bg, color: fg, padding: '16px', borderRadius: '8px', border: `2px solid ${blend(pair[0], pair[1])}` }}>
                <div style={{ fontWeight: 'bold', fontSize: '1.1rem', marginBottom: '4px' }}>{pair}: {data.text}</div>
                <div style={{ fontSize: '0.85rem', opacity: 0.9, marginBottom: '8px', fontStyle: 'italic' }}>{data.sub}</div>
                <div style={{ fontSize: '0.8rem', lineHeight: '1.4', opacity: 0.95, marginBottom: '8px' }}>{data.details}</div>
                {data.sourceText && (
                  <div style={{ fontSize: '0.7rem', opacity: 0.7, fontStyle: 'italic', marginBottom: '10px' }}>
                    Source: <a href={data.sourceUrl} target="_blank" rel="noopener noreferrer" style={{ color: fg, textDecoration: 'underline' }}>{data.sourceText}</a>
                  </div>
                )}
                <div style={{ fontSize: '0.65rem', opacity: 0.85, marginBottom: '5px', fontWeight: '600' }}>Scryfall search:</div>
                <div style={{ display: 'flex', gap: '4px', flexWrap: 'wrap' }}>
                  <a href={exactSearchUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '4px 10px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '3px', fontSize: '0.65rem', fontWeight: '600' }}>
                    {pair[0]}&amp;{pair[1]}
                  </a>
                  <a href={orSearchUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '4px 10px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '3px', fontSize: '0.65rem', fontWeight: '600' }}>
                    {pair[0]}‚à™{pair[1]}
                  </a>
                </div>
              </div>
            );
          })}
        </div>
      </div>

      {/* Secondary Archetypes */}
      <div id="secondary-archetypes" style={{ width: '100%', marginTop: '32px', marginBottom: '48px' }}>
        <h2 style={{ fontSize: '1.3rem', fontWeight: '700', color: '#111827', marginBottom: '8px', paddingBottom: '8px', borderBottom: '2px solid #9CA3AF' }}>
          Off-Arch Splashes (Allied Color Pairs)
        </h2>
        <p style={{ fontSize: '0.85rem', color: '#6B7280', marginBottom: '16px' }}>
          These 5 allied color pairs have no dedicated archetype in TMT. See splash guidance below.
        </p>
        <div className="archetype-grid" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(min(100%, 150px), 1fr))', gap: '12px', alignSelf: 'stretch' }}>
          {secondaryPairs.map(([pair, data]) => {
            const { bg, fg } = getLabelColors(pair[0], pair[1]);
            const exactSearchUrl = `https://scryfall.com/search?q=set%3Atmt+id%3D${pair}`;
            const orSearchUrl = `https://scryfall.com/search?q=set%3Atmt+(id%3D${pair[0]}+or+id%3D${pair[1]}+or+id%3D${pair})`;
            return (
              <div key={pair} style={{ backgroundColor: bg, color: fg, padding: '16px', borderRadius: '8px', border: `1px dashed ${blend(pair[0], pair[1])}`, opacity: 0.85 }}>
                <div style={{ fontWeight: 'bold', fontSize: '1.1rem', marginBottom: '4px' }}>{pair}: {data.text}</div>
                <div style={{ fontSize: '0.85rem', opacity: 0.9, marginBottom: '8px', fontStyle: 'italic' }}>{data.sub}</div>
                <div style={{ fontSize: '0.8rem', lineHeight: '1.4', opacity: 0.95, marginBottom: '8px' }}>{data.details}</div>
                {data.sourceText && (
                  <div style={{ fontSize: '0.7rem', opacity: 0.7, fontStyle: 'italic', marginBottom: '10px' }}>
                    Source: <a href={data.sourceUrl} target="_blank" rel="noopener noreferrer" style={{ color: fg, textDecoration: 'underline' }}>{data.sourceText}</a>
                  </div>
                )}
                <div style={{ fontSize: '0.65rem', opacity: 0.85, marginBottom: '5px', fontWeight: '600' }}>Scryfall search:</div>
                <div style={{ display: 'flex', gap: '4px', flexWrap: 'wrap' }}>
                  <a href={exactSearchUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '4px 10px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '3px', fontSize: '0.65rem', fontWeight: '600' }}>
                    {pair[0]}&amp;{pair[1]}
                  </a>
                  <a href={orSearchUrl} target="_blank" rel="noopener noreferrer" style={{ display: 'inline-block', padding: '4px 10px', backgroundColor: fg, color: bg, textDecoration: 'none', borderRadius: '3px', fontSize: '0.65rem', fontWeight: '600' }}>
                    {pair[0]}‚à™{pair[1]}
                  </a>
                </div>
              </div>
            );
          })}
        </div>
      </div>

      {/* Hover Info Panel ‚Äî triggered by SVG wheel only */}
      <InfoPanel pair={activePair} onHover={() => { if (pairTimeoutRef.current) { clearTimeout(pairTimeoutRef.current); pairTimeoutRef.current = null; } }} onLeave={handlePairLeave} />
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<TMNTColorWheel />);
  </script>
</body>
</html>
